{{- $interactive := stdinIsATTY -}}

{{- $headless := false -}}
{{- $agekey := false -}}

{{- $hostname := .chezmoi.hostname -}}

{{- if eq $hostname "pwnyboy" -}}
{{-   $headless = true -}}
{{- end -}}

{{- if hasKey . "headless" -}}
{{-   $headless = .headless -}}
{{- else if $interactive -}}
{{-   $headless = promptBool "headless" -}}
{{- end -}}

{{- if hasKey . "agekey" -}}
{{-   $agekey = .agekey -}}
{{- else if $interactive -}}
{{-   $headless = promptBool "agekey" -}}
{{- end -}}

{{- if $interactive -}}
{{-   writeToStdout "ðŸ’¡ Tip: you can re-enter your data with `chezmoi init --data=false`.\n" -}}
{{- end -}}

data:
  headless: {{ $headless }}
  agekey: {{ $agekey }}
format: yaml
encryption: age
{{- if $agekey }}
age:
  identity: {{ .chezmoi.homeDir }}/.config/sops/age/keys.txt
{{- end }}
merge:
  command: vim.nox
  args:
    - -d
    - "{{ "{{ .Destination }}" }}"
    - "{{ "{{ .Source }}" }}"
    - "{{ "{{ .Target }}" }}"
git:
  autoAdd: true
